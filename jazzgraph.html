<!doctype html>
<html class="no-js" lang="en">
<head>
        <meta charset="utf-8">
          <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <script src="js/prettify.js"></script>
  <script src="js/sigma.min.js"></script>
<style type="text/css">
/* RESET */
body{

}
</style>
</head>
<body onload="prettyPrint();">
<script src="js/jquery.min.js"></script>
 <script type="text/javascript">
//


function getImage(title)
{
document.getElementById('images').innerHTML = '';
var txtHtml = "";

$.getJSON("http://en.wikipedia.org/w/api.php?action=query&prop=images&titles="+title+"&format=json&callback=?", function(data)  {
 
 $.each(data.query.pages , function(key, val) {
   $.each(val.images , function(cle, valeur) {
     
                    $.getJSON("http://en.wikipedia.org/w/api.php?action=query&titles="+valeur.title.replace(" ","_") + "&prop=imageinfo&iiprop=url&format=json&callback=?", function(data)  {
                     
                     $.each(data.query.pages , function(key, val) {

                       $.each(val.imageinfo , function(cle, valeur) {
                          //txtHtml = '<img src='+ valeur.url + ' width=100 height=100/>';
                           $("<img/>").attr("src", valeur.url).attr("width",220).attr("height",220).appendTo("#images");
                           //$("<img/>").attr("src", valeur.url).attr("width",220).attr("height",220).appendTo("#images");
                           //http://en.wikipedia.org/w/api.php?action=query&titles=".$term."&prop=images&format=json&imlimit=5
                          });

                         });
                       });
                       //alert (valeur.title.replace(" ","_"));

        if ( cle == 5 ) return false;
   });

 });

  });
}
 
 
 </script>
<script type="text/javascript">
  var mapIdLabel = new Object();
</script>
  
    
  <div class="container">
    <div class="row">
<select onchange="
init(this[this.selectedIndex].value)
;getImage(this[this.selectedIndex].value);">
 
<option value='Al_Haig'>Al Haig</option>
<option value='Art_Blakey'>Art Blakey</option>
<option value='Art_Pepper'>Art Pepper</option>
<option value='Barney_Kessel'>Barney Kessel</option>
<option value='Barry_Harris'>Barry Harris</option>
<option value='Betty_Carter'>Betty Carter</option>
<option value='Bill_Evans'>Bill Evans</option>
<option value='Billy_Eckstine'>Billy Eckstine</option>
<option value='Blue_Mitchell'>Blue Mitchell</option>
<option value='Buddy_DeFranco'>Buddy DeFranco</option>
<option value='Bud_Powell'>Bud Powell</option>
<option value='Cannonball_Adderley'>Cannonball Adderley</option>
<option value='Carl_Fontana'>Carl Fontana</option>
<option value='Charles_McPherson'>Charles McPherson</option>
<option value='Charles_Mingus'>Charles Mingus</option>
<option value='Charlie_Christian'>Charlie Christian</option>
<option value='Charlie_Parker'>Charlie Parker</option>
<option value='Chet_Baker'>Chet Baker</option>
<option value='Chuck_Wayne'>Chuck Wayne</option>
<option value='Clifford_Brown'>Clifford Brown</option>
<option value='Curtis_Fuller'>Curtis Fuller</option>
<option value='Dexter_Gordon'>Dexter Gordon</option>
<option value='Dizzy_Gillespie'>Dizzy Gillespie</option>
<option value='Dodo_Marmarosa'>Dodo Marmarosa</option>
<option value='Don_Byas'>Don Byas</option>
<option value='Duke_Jordan'>Duke Jordan</option>
<option value='Ella_Fitzgerald'>Ella Fitzgerald</option>
<option value='Fats_Navarro'>Fats Navarro</option>
<option value='Frank_Marocco'>Frank Marocco</option>
<option value='Frank_Rosolino'>Frank Rosolino</option>
<option value='George_Wallington'>George Wallington</option>
<option value='Herb_Ellis'>Herb Ellis</option>
<option value='Horace_Silver'>Horace Silver</option>
<option value='Howard_McGhee'>Howard McGhee</option>
<option value='Jimmy_Cobb'>Jimmy Cobb</option>
<option value='Jimmy_Raney'>Jimmy Raney</option>
<option value='J._J._Johnson'>J. J. Johnson</option>
<option value='Joe_Pass'>Joe Pass</option>
<option value='John_Coltrane'>John Coltrane</option>
<option value='John_Lewis'>John Lewis</option>
<option value='Kenny_Burrell'>Kenny Burrell</option>
<option value='Kenny_Clarke'>Kenny Clarke</option>
<option value='Kenny_Dorham'>Kenny Dorham</option>
<option value='Lee_Konitz'>Lee Konitz</option>
<option value='Lennie_Tristano'>Lennie Tristano</option>
<option value='Lou_Levy'>Lou Levy</option>
<option value='Lucky_Thompson'>Lucky Thompson</option>
<option value='Max_Roach'>Max Roach</option>
<option value='Miles_Davis'>Miles Davis</option>
<option value='Milt_Hinton'>Milt Hinton</option>
<option value='Milt_Jackson'>Milt Jackson</option>
<option value='Mort_Weiss'>Mort Weiss</option>
<option value='Oscar_Pettiford'>Oscar Pettiford</option>
<option value='Pat_Martino'>Pat Martino</option>
<option value='Paul_Chambers'>Paul Chambers</option>
<option value='Percy_Heath'>Percy Heath</option>
<option value='Philly_Joe_Jones'>Philly Joe Jones</option>
<option value='Ray_Brown'>Ray Brown</option>
<option value='Red_Rodney'>Red Rodney</option>
<option value='Ronnie_Singer'>Ronnie Singer</option>
<option value='Roy_Haynes'>Roy Haynes</option>
<option value='Sadik_Hakim'>Sadik Hakim</option>
<option value='Sarah_Vaughan'>Sarah Vaughan</option>
<option value='Shadow_Wilson'>Shadow Wilson</option>
<option value='Sonny_Rollins'>Sonny Rollins</option>
<option value='Sonny_Stitt'>Sonny Stitt</option>
<option value='Stan_Levey'>Stan Levey</option>
<option value='Tadd_Dameron'>Tadd Dameron</option>
<option value='Thelonious_Monk'>Thelonious Monk</option>
<option value='Tommy_Potter'>Tommy Potter</option>
<option value='Walter_Davis'>Walter Davis</option>
<option value='Wardell_Gray'>Wardell Gray</option>
<option value='Wes_Montgomery'>Wes Montgomery</option>
</select>
  
  <div class="span12 sigma-parent" id="sigma-example-parent">
    <div class="sigma-expand" id="sigma-example"></div>
  </div>
</div>

<script src="js/sigma.parseGexf.js"></script>

<script type="text/javascript">function init(path) {
  /**
   * First, let's instanciate sigma.js :
   */
   document.getElementById('sigma-example').innerHTML = '';
  var sigInst = sigma.init($('#sigma-example')[0]).drawingProperties({
   defaultLabelColor: '#fff',
   defaultLabelSize: 14,
   defaultLabelBGColor: '#fff',
   defaultLabelHoverColor: '#000',
   labelThreshold: 6,
   defaultEdgeType: ''
  }).graphProperties({
   minNodeSize: 0.5,
   maxNodeSize: 50,
   minEdgeSize: 1,
   maxEdgeSize: 1
  });


  // (requires "sigma.parseGexf.js" to be executed)
   sigInst.parseGexf('gexf/' + path + ".gexf");

  /**
   * Now, here is the code that shows the popup :
   */
  (function(){
    var popUp;
    var albums = new Array();

    // This function is used to generate the attributes list from the node attributes.
    // Since the graph comes from GEXF, the attibutes look like:
    // [
    //   { attr: 'Lorem', val: '42' },
    //   { attr: 'Ipsum', val: 'dolores' },
    //   ...
    //   { attr: 'Sit',   val: 'amet' }
    // ]
    function attributesToString(attr) {
      return '<ul>' +
        attr.map(function(o){
          return '<li>' + o.attr + ' : ' + o.val + '</li>';
        }).join('') +
        '</ul>';
    }

    function albumsToString(attr) {
      attr.sort();
      return '' +
        attr.map(function(o){
          return '' + o + '<br>';
        }).join('') +
        '';
    }



    function showNodeInfo(event) {
      popUp && popUp.remove();
      
      albums = new Array();
      var arAlbums = new Array();
      var nodes = event.content;
      var neighbors = {};
      var node;
      var libelle = mapIdLabel[event.content[0]];
      sigInst.iterEdges(function(e){
         if(nodes.indexOf(e.source)>=0 || nodes.indexOf(e.target)>=0)
         {
            neighbors[e.source] = 1;
            neighbors[e.target] = 1;

            var artiste = '';

            if (libelle == mapIdLabel[e.target])
            {
               artiste = mapIdLabel[e.source];
            }
            else
               artiste = mapIdLabel[e.target];

            if (arAlbums.indexOf(e.label) == -1)
            {
              albums.push('<b>' + artiste + ' : </b> ' + e.label);
              arAlbums.push(e.label);
            }
         }
         }).iterNodes(function(n){
           node = n;

            if(!neighbors[n.id]){
            n.hidden = 1;
            alert(n.hidden);
            }else{
            n.hidden = 0;
            }
      },[event.content[0]]).draw(2,2,2);




      popUp = $(
            '<div class="node-info-popup"></div>Albums'
      )
      .append(
      getImage(libelle.replace(' ','_'))
      ).append(
        // The GEXF parser stores all the attributes in an array named
        // 'attributes'. And since sigma.js does not recognize the key
        // 'attributes' (unlike the keys 'label', 'color', 'size' etc),
        // it stores it in the node 'attr' object :
        //attributesToString( node['attr']['attributes'] )
        albumsToString(albums)
      ).attr(
        'id',
        'node-info'+sigInst.getID()
      ).css({
        'display': 'inline-block',
        'border-radius': 3,
        'padding': 5,
        'background': '#222222',
        'color': '#fff',
        'font-family' :' Arial, Helvetica, sans-serif',
        'font-size' : '10px',
        'box-shadow': '0 0 4px #666',
        'position': 'absolute',
        'left': node.displayX,
        'top': node.displayY+15
      });

      $('ul',popUp).css('margin','0 0 0 0px');

      $('#sigma-example').append(popUp);
    }

    function hideNodeInfo(event) {
      popUp && popUp.remove();
      popUp = false;

      sigInst.iterEdges(function(e){
         e.hidden = 0;
         }).iterNodes(function(n){
            n.hidden = 0;
            }).draw(2,2,2);
    }

    sigInst.bind('overnodes',showNodeInfo).bind('outnodes',hideNodeInfo);
    /*
sigInst.bind('overnodes',function(event){
      var nodes = event.content;
      var neighbors = {};
      sigInst.iterEdges(function(e){
         if(nodes.indexOf(e.source)>=0 || nodes.indexOf(e.target)>=0){
         neighbors[e.source] = 1;
         neighbors[e.target] = 1;
         }
         }).iterNodes(function(n){
            if(!neighbors[n.id]){
            alert(rr);
            n.hidden = 1;
            }else{
            n.hidden = 0;
            }
            }).draw(2,2,2);
      }).bind('outnodes',function(){
         sigInst.iterEdges(function(e){
            e.hidden = 0;
            }).iterNodes(function(n){
               n.hidden = 0;
               }).draw(2,2,2);
               });*/


sigInst.draw();
  })();
}

if (document.addEventListener) {
  document.addEventListener('DOMContentLoaded', init, false);
} else {
  window.onload = init;
}
</script>
 <div id="images">
 </div>

<style type="text/css">
  /* sigma.js context : */
  .sigma-parent {
    position: relative;
    border-radius: 4px;
    -moz-border-radius: 4px;
    -webkit-border-radius: 4px;
    background: #222;
    height: 500px;
  }
  .sigma-expand {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
  }
  .buttons-container{
    padding-bottom: 8px;
    padding-top: 12px;
  }
</style>



  </div>
</body>
</html>

